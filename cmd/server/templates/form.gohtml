<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">{{- /*gotype: parentscontactform/internal/models.TemplateData*/ -}}
        {{.}}</title>
    <link rel="stylesheet" href="/static/css/form.css">
</head>
<body>
<!-- Navigation Bar -->
<nav class="navbar">
    <div class="navbar__welcome">Welcome, <span class="navbar__user">{{.CurrentUserInfo.FirstName}} {{.CurrentUserInfo.Surname}}</span></div>
    <div>
        <a href="/logout" class="btn--logout">Log Out</a>
    </div>
</nav>

<!-- Main Content -->
<main class="container">
    <div class="form-card">
        <div class="form-header">
            <h1>Please Update Your Details</h1>
            <div id="backBtn" class="backBtn" onclick="showContactCards()">
                ‚Üê Back
            </div>
        </div>

        <div id="contact-cards" class="contact-cards">
            <div class="contact-cards__header">
                <h2>Select Contact</h2>
                <p id="selectContactSubtitle">Please choose the contact to update</p>
            </div>

            <div class="contact-cards__grid">
                <!-- Contact Card 1 -->
                <div id="primaryCard" class="contact-card" onclick="showContactForm('primaryContactForm')">
                    <div class="contact-card__content">
                        <div id="primaryCardInitial" class="contact-card__avatar">{{.ParentContactInfo.Initials}}</div>
                        <div class="contact-card__info">
                            <h3 class="contact-card__name">{{.ParentContactInfo.Forename}} {{.ParentContactInfo.Surname}}</h3>
                            <p class="contact-card__relationship">Primary</p>
                        </div>
                    </div>
                    <div class="contact-card__indicator">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                            <path d="M9 18l6-6-6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                </div>

                <!-- Contact Card 2 -->
                <div id="secondaryCard" class="contact-card" onclick="showContactForm('secondaryContactForm')">
                    <div class="contact-card__content">
                        <div id="secondaryCardInitial" class="contact-card__avatar">{{.ParentContactInfo.SecondaryInitials}}</div>
                        <div class="contact-card__info">
                            <h3 class="contact-card__name">{{.ParentContactInfo.SecondaryForename}} {{.ParentContactInfo.SecondarySurname}}</h3>
                            <p class="contact-card__relationship">Secondary</p>
                        </div>
                    </div>
                    <div class="contact-card__indicator">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                            <path d="M9 18l6-6-6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                </div>

                <div class="contact-cards__header">
                    <h2>Select Child</h2>
                    <p id="selectContactSubtitle">Please choose the child to update</p>
                </div>

                <!-- Children Cards -->

                {{range .ChildrenInfo}}
                    {{if gt .Status 0}}
                        <div id="childCard" class="contact-card" onclick="showChildForm('{{.SchoolId}}')">
                            <div class="contact-card__content">
                                <div id="childCardInitial" class="contact-card__avatar">P</div>
                                <div class="contact-card__info">
                                    <h3 class="contact-card__name">{{.Forename}} {{.Surname}}</h3>
                                    <p class="contact-card__relationship">{{.YearName}}</p>
                                </div>
                            </div>
                            <div class="contact-card__indicator">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                                    <path d="M9 18l6-6-6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                        </div>
                    {{end}}
                {{end}}

            </div>
        </div>

        <form id="primaryContactForm">
            <div class="form-group">
                <label for="email" class="form-label">Email Address</label>
                <input type="email" class="form-control" id="email" name="email" value="{{.ParentContactInfo.EmailAddress1}}" readonly>
                <small style="color: #6c757d; display: block; margin-top: 0.25rem;">Email cannot be changed.</small>
            </div>

            <div class="form-group">
                <label for="title" class="form-label">Title</label>
                <select id="title" name="title" class="form-control">
                    <option value="">Please select...</option>
                    <option value="Mr"   {{if eq .ParentContactInfo.Title "Mr"}}selected{{end}}>Mr</option>
                    <option value="Mrs"  {{if eq .ParentContactInfo.Title "Mrs"}}selected{{end}}>Mrs</option>
                    <option value="Miss" {{if eq .ParentContactInfo.Title "Miss"}}selected{{end}}>Miss</option>
                    <option value="Ms"   {{if eq .ParentContactInfo.Title "Ms"}}selected{{end}}>Ms</option>
                    <option value="Dr"   {{if eq .ParentContactInfo.Title "Dr"}}selected{{end}}>Dr</option>
                    <option value="Prof" {{if eq .ParentContactInfo.Title "Prof"}}selected{{end}}>Professor</option>
                    <option value="Fr"  {{if eq .ParentContactInfo.Title "Fr"}}selected{{end}}>Fr</option>
                </select>
            </div>

            <div class="form-group">
                <label for="forename" class="form-label">Forename</label>
                <input type="text" class="form-control" id="forename" name="forename" value="{{or .ParentContactInfo.Forename ""}}">
            </div>

            <div class="form-group">
                <label for="surname" class="form-label">Surname</label>
                <input type="text" class="form-control" id="surname" name="surname" value="{{or .ParentContactInfo.Surname ""}}">
            </div>

            <div id="addressSearch" class="form-group">
                <label for="autocomplete" class="form-label">Address Search</label>
            </div>

            <div class="form-group">
                <label for="addressLine0" class="form-label">Address Line 1</label>
                <input type="text" class="form-control" id="addressLine0" name="addressLineOne" placeholder="Enter in Address Search" value="{{or .ParentContactInfo.FirstLineAddress ""}}" readonly>
            </div>

            <div class="form-group">
                <label for="addressLine1" class="form-label">Address Line 2</label>
                <input type="text" class="form-control" id="addressLine1" name="addressLineTwo"  value="{{or .ParentContactInfo.SecondLineAddress ""}}" readonly>
            </div>

            <div class="form-group">
                <label for="addressLine2" class="form-label">Address Line 3</label>
                <input type="text" class="form-control" id="addressLine2" name="addressLineThree"  value="{{or .ParentContactInfo.ThirdLineAddress ""}}" readonly>
            </div>

            <div class="form-group">
                <label for="postalCode" class="form-label">Post Code</label>
                <input type="text" class="form-control" id="postalCode" name="postalCode" value="{{or .ParentContactInfo.Postcode ""}}" readonly>
            </div>

            <div class="form-group">
                <label for="county" class="form-label">County</label>
                <input type="text" class="form-control" id="county" name="county" value="{{or .ParentContactInfo.County ""}}" readonly>
            </div>

            <div class="form-group">
                <label for="phone" class="form-label">Phone Number</label>
                <input type="tel" class="form-control" id="phone" name="phone" placeholder="e.g., +44 20 7946 0958" value="{{or .ParentContactInfo.Mobile1 ""}}">
            </div>

            <div class="form-group">
                <button type="submit" class="btn--submit">Save Changes</button>
            </div>
        </form>

        <form id="secondaryContactForm">
            <!-- Example Form Fields - Customize these! -->

            <div class="form-group">
                <label for="email" class="form-label">Email Address</label>
                <input type="email" class="form-control" id="email" name="email" value="{{.ParentContactInfo.EmailAddress2}}" readonly>
                <small style="color: #6c757d; display: block; margin-top: 0.25rem;">Email cannot be changed.</small>
            </div>

            <div class="form-group">
                <label for="title" class="form-label">Title</label>
                <select id="title" name="title" class="form-control">
                    <option value="">Please select...</option>
                    <option value="Mr"   {{if eq .ParentContactInfo.SecondaryTitle "Mr"}}selected{{end}}>Mr</option>
                    <option value="Mrs"  {{if eq .ParentContactInfo.SecondaryTitle "Mrs"}}selected{{end}}>Mrs</option>
                    <option value="Miss" {{if eq .ParentContactInfo.SecondaryTitle "Miss"}}selected{{end}}>Miss</option>
                    <option value="Ms"   {{if eq .ParentContactInfo.SecondaryTitle "Ms"}}selected{{end}}>Ms</option>
                    <option value="Dr"   {{if eq .ParentContactInfo.SecondaryTitle "Dr"}}selected{{end}}>Dr</option>
                    <option value="Prof" {{if eq .ParentContactInfo.SecondaryTitle "Prof"}}selected{{end}}>Professor</option>
                    <option value="Fr"  {{if eq .ParentContactInfo.SecondaryTitle "Fr"}}selected{{end}}>Fr</option>
                </select>
            </div>

            <div class="form-group">
                <label for="forename" class="form-label">Forename</label>
                <input type="text" class="form-control" id="forename" name="forename" value="{{or .ParentContactInfo.SecondaryForename ""}}">
            </div>

            <div class="form-group">
                <label for="surname" class="form-label">Surname</label>
                <input type="text" class="form-control" id="surname" name="surname" value="{{or .ParentContactInfo.SecondarySurname ""}}">
            </div>

            <div id="addressSearchTwo" class="form-group">
                <label for="autocomplete" class="form-label">Address Search</label>
            </div>

            <div class="form-group">
                <label for="secondaryAddressLine0" class="form-label">Address Line 1</label>
                <input type="text" class="form-control" id="secondaryAddressLine0" name="addressLineOne" placeholder="Enter in Address Search" value="{{or .ParentContactInfo.FirstLineAddress ""}}" readonly>
            </div>

            <div class="form-group">
                <label for="secondaryAddressLine1" class="form-label">Address Line 2</label>
                <input type="text" class="form-control" id="secondaryAddressLine1" name="addressLineTwo"  value="{{or .ParentContactInfo.SecondLineAddress ""}}" readonly>
            </div>

            <div class="form-group">
                <label for="secondaryAddressLine2" class="form-label">Address Line 3</label>
                <input type="text" class="form-control" id="secondaryAddressLine2" name="addressLineThree"  value="{{or .ParentContactInfo.ThirdLineAddress ""}}" readonly>
            </div>

            <div class="form-group">
                <label for="secondaryPostalCode" class="form-label">Post Code</label>
                <input type="text" class="form-control" id="secondaryPostalCode" name="postalCode" value="{{or .ParentContactInfo.Postcode ""}}" readonly>
            </div>

            <div class="form-group">
                <label for="secondaryCounty" class="form-label">County</label>
                <input type="text" class="form-control" id="secondaryCounty" name="secondaryCounty" value="{{or .ParentContactInfo.County ""}}" readonly>
            </div>

            <div class="form-group">
                <label for="phone" class="form-label">Phone Number</label>
                <input type="tel" class="form-control" id="phone" name="phone" placeholder="e.g., +44 20 7946 0958" value="{{or .ParentContactInfo.Mobile2 ""}}">
            </div>

            <div class="form-group">
                <button type="submit" class="btn--submit">Save Changes</button>
            </div>
        </form>

        <form id="childForm">
            <div class="form-group">
                <label for="medsUsed" class="form-label">Medical Conditions</label>
                <!-- Conditions Table -->
                <div class="conditions-table" id="conditionsTable">
                    <table id="table">
                        <thead>
                        <tr>
                            <th>Condition Type</th>
                            <th>Condition</th>
                            <th>Medication</th>
                            <th>Notes</th>
                            <th>Actions</th>
                        </tr>
                        </thead>
                        <tbody id="conditionsBody"></tbody>
                    </table>

                    <!-- Empty State -->
                    <div class="empty-state" id="emptyState">
                        <p>No medical conditions added yet.</p>
                    </div>
                </div>

                <!-- Add Condition Button -->
                <button type="button" class="btn--add-condition" onclick="openConditionModal()">
                    + Add Condition
                </button>
            </div>

            <div class="form-group">
                <label class="form-label">Consent to administer general medication</label>
                <div class="radio-group">
                    <input type="radio" id="yes-med-consent" name="medConsent" value="yes" class="radio-input">
                    <label for="yes-med-consent" class="radio-label">Yes</label>

                    <input type="radio" id="no-med-consent" name="medConsent" value="no" class="radio-input">
                    <label for="no-med-consent" class="radio-label">No</label>
                </div>
            </div>

            <div class="form-group">
                <label class="form-label">Permission to use images of your child for internal and external marketing</label>
                <div class="radio-group">
                    <input type="radio" id="yes-photo-consent" name="photoConsent" value="yes" class="radio-input">
                    <label for="yes-photo-consent" class="radio-label">Yes</label>

                    <input type="radio" id="no-photo-consent" name="photoConsent" value="no" class="radio-input">
                    <label for="no-photo-consent" class="radio-label">No</label>
                </div>
            </div>

            <div class="form-group">
                <label for="ealSpoken" class="form-label">If your child has english as an additional language, please select their other fluent languages.</label>
                <select id="ealSpoken" name="ealSpoken" class="form-control" multiple>
                    {{range $.Languages}}
                        <option value="{{.Name}}" id="{{.Name}}">{{.Name}}</option>
                    {{end}}
                </select>
            </div>

            <div class="form-group">
                <button type="submit" class="btn--submit">Save Changes</button>
            </div>
        </form>

        <!-- Condition Modal -->
        <div class="modal" id="conditionModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Add Medical Condition</h3>
                    <button type="button" class="modal-close" onclick="closeConditionModal()">&times;</button>
                </div>

                <form id="conditionForm" class="modal-body">
                    <div class="form-group">
                        <label for="conditionSelect" class="form-label">Condition Type *</label>
                        <select id="conditionSelect" class="form-control" required>
                            <option value="">Select a condition</option>
                            {{range .ConditionTypes}}
                                <option id="condType{{.Id}}" value="{{.Name}}">{{.Name}}</option>
                            {{end}}
                            <option value="other">Other</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="conditionName" class="form-label">Condition *</label>
                        <input type="text" id="conditionName" class="form-control" placeholder="Condition Name" required>
                    </div>

                    <div class="form-group">
                        <label for="medicationName" class="form-label">Medication *</label>
                        <input type="text" id="medicationName" class="form-control" required>
                    </div>

                    <div class="form-group">
                        <label for="conditionNotes" class="form-label">Notes</label>
                        <textarea id="conditionNotes" class="form-control" rows="3" placeholder="Additional notes about this condition and medication"></textarea>
                    </div>
                </form>

                <div class="modal-footer">
                    <button type="button" class="btn--secondary" onclick="closeConditionModal()">Cancel</button>
                    <button type="button" class="btn--primary" onclick="addCondition()">Add Condition</button>
                </div>
            </div>
        </div>

        <div id="success-message" class="alert alert-success" style="display: none;">
            <strong>Thank you!</strong> Your details have been successfully updated.
        </div>
    </div>
</main>

<script>
    (g=>{var h,a,k,p="The Google Maps JavaScript API",c="google",l="importLibrary",q="__ib__",m=document,b=window;b=b[c]||(b[c]={});var d=b.maps||(b.maps={}),r=new Set,e=new URLSearchParams,u=()=>h||(h=new Promise(async(f,n)=>{await (a=m.createElement("script"));e.set("libraries",[...r]+"");for(k in g)e.set(k.replace(/[A-Z]/g,t=>"_"+t[0].toLowerCase()),g[k]);e.set("callback",c+".maps."+q);a.src=`https://maps.${c}apis.com/maps/api/js?`+e;d[q]=f;a.onerror=()=>h=n(Error(p+" could not load."));a.nonce=m.querySelector("script[nonce]")?.nonce||"";m.head.append(a)}));d[l]?console.warn(p+" only loads once. Ignoring:",g):d[l]=(f,...n)=>r.add(f)&&u().then(()=>d[l](f,...n))})({
        key: "AIzaSyBxUJIUrcYYrVqWyg_kxqD0DA197w17yOc",
        v: "weekly",
        // Use the 'v' parameter to indicate the version to use (weekly, beta, alpha, etc.).
        // Add other bootstrap parameters as needed, using camel case.
    });
</script>
<script src="/static/js/form.js"></script>
</body>
</html>